select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.3, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
geom_ribbon(aes(ymin = low.pred, ymax = up.pred),
alpha=0.7, fill = "#00BFC4") +
geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 30)) +
labs(x = "YEARS OUT", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=25)) +
theme_classic())
}
plot_lat_gg(171)
plot_lat_gg <- function(pix) {
px <- as.character(pix)
pxv <- paste("V",as.character(pix), sep = "")
## re-organize latent cover data
#median values
lat.med <- med.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.med", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat lower ci values
lat.low <- low.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.low", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat upper ci values
lat.up <- up.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.up", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
## re-organize predicted cover data
# median predicted values
med.pred <- med.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "med.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# low ci prediction
low.pred <- low.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "low.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
up.pred <- up.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "up.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.5, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
geom_ribbon(aes(ymin = low.pred, ymax = up.pred),
alpha=0.3, fill = "#00BFC4") +
geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 30)) +
labs(x = "YEARS OUT", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=25)) +
theme_classic())
}
plot_lat_gg(171)
plot_lat_gg <- function(pix) {
px <- as.character(pix)
pxv <- paste("V",as.character(pix), sep = "")
## re-organize latent cover data
#median values
lat.med <- med.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.med", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat lower ci values
lat.low <- low.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.low", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat upper ci values
lat.up <- up.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.up", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
## re-organize predicted cover data
# median predicted values
med.pred <- med.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "med.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# low ci prediction
low.pred <- low.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "low.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
up.pred <- up.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "up.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred) %>% mutate(year = year+1985)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.5, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
geom_ribbon(aes(ymin = low.pred, ymax = up.pred),
alpha=0.3, fill = "#00BFC4") +
geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 30)) +
labs(x = "YEAR", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=25)) +
theme_classic())
}
plot_lat_gg(171)
plot_lat_gg(224)
plot_lat_gg(624)
plot_lat_gg(724)
plot_lat_gg(734)
plot_lat_gg(744)
plot_lat_gg(754)
plot_lat_gg(764)
plot_lat_gg(774)
plot_lat_gg <- function(pix) {
px <- as.character(pix)
pxv <- paste("V",as.character(pix), sep = "")
## re-organize latent cover data
#median values
lat.med <- med.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.med", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat lower ci values
lat.low <- low.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.low", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat upper ci values
lat.up <- up.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.up", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
## re-organize predicted cover data
# median predicted values
med.pred <- med.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "med.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# low ci prediction
low.pred <- low.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "low.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
up.pred <- up.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "up.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred) %>% mutate(year = year+1985)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.5, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
geom_ribbon(aes(ymin = low.pred, ymax = up.pred),
alpha=0.3, fill = "#00BFC4") +
geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 20)) +
labs(x = "YEAR", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=25)) +
theme_classic())
}
plot_lat_gg(774)
ggsave("R:/Shriver_Lab/PJspread/evaluate_out_of_sample/35y_insample_predictions/single_pixel_774_pred_5yr_avg_init_w_latent.png", plot = last_plot(), dpi = 400)
plot_lat_gg <- function(pix) {
px <- as.character(pix)
pxv <- paste("V",as.character(pix), sep = "")
## re-organize latent cover data
#median values
lat.med <- med.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.med", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat lower ci values
lat.low <- low.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.low", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat upper ci values
lat.up <- up.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.up", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
## re-organize predicted cover data
# median predicted values
med.pred <- med.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "med.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# low ci prediction
low.pred <- low.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "low.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
up.pred <- up.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "up.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred) %>% mutate(year = year+1985)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.5, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
geom_ribbon(aes(ymin = low.pred, ymax = up.pred),
alpha=0.3, fill = "#00BFC4") +
geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 20)) +
labs(x = "YEAR", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=5)) +
theme_classic())
}
plot_lat_gg(774)
ggsave("R:/Shriver_Lab/PJspread/evaluate_out_of_sample/35y_insample_predictions/single_pixel_774_pred_5yr_avg_init_w_latent.png", plot = last_plot(), dpi = 400)
ggsave("R:/Shriver_Lab/PJspread/evaluate_out_of_sample/35y_insample_predictions/single_pixel_774_pred_5yr_avg_init_w_latent.png", plot = last_plot(), width = 4, height = 4, dpi = 400)
ggsave("R:/Shriver_Lab/PJspread/evaluate_out_of_sample/35y_insample_predictions/single_pixel_774_pred_5yr_avg_init_w_latent.png", plot = last_plot(), width = 3, height = 2, dpi = 400)
ggsave("R:/Shriver_Lab/PJspread/evaluate_out_of_sample/35y_insample_predictions/single_pixel_774_pred_5yr_avg_init_w_latent.png", plot = last_plot(), width = 3, height = 2.5, dpi = 400)
ggsave("R:/Shriver_Lab/PJspread/evaluate_out_of_sample/35y_insample_predictions/single_pixel_774_pred_5yr_avg_init_w_latent.png", plot = last_plot(), width = 6, height = 4, dpi = 400)
plot_lat_gg <- function(pix) {
px <- as.character(pix)
pxv <- paste("V",as.character(pix), sep = "")
## re-organize latent cover data
#median values
lat.med <- med.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.med", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat lower ci values
lat.low <- low.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.low", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat upper ci values
lat.up <- up.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.up", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
## re-organize predicted cover data
# median predicted values
med.pred <- med.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "med.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# low ci prediction
low.pred <- low.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "low.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
up.pred <- up.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "up.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred) %>% mutate(year = year+1985)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
#geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.5, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
#geom_ribbon(aes(ymin = low.pred, ymax = up.pred), alpha=0.3, fill = "#00BFC4") +
#geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 20)) +
labs(x = "YEAR", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=5)) +
theme_classic())
}
plot_lat_gg(774)
plot_lat_gg <- function(pix) {
px <- as.character(pix)
pxv <- paste("V",as.character(pix), sep = "")
## re-organize latent cover data
#median values
lat.med <- med.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.med", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat lower ci values
lat.low <- low.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.low", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
# lat upper ci values
lat.up <- up.lat %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "lat.up", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year))
## re-organize predicted cover data
# median predicted values
med.pred <- med.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "med.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# low ci prediction
low.pred <- low.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "low.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
up.pred <- up.pred.clim %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "up.pred", names_to = "pixel") %>%
filter(pixel == pxv) %>%
select(!pixel) %>%
mutate(year = as.numeric(year)) %>%
filter(year !=1 )  # remove first year (true value, not part of the forecast)
# observed
Ndat <- N %>% as.data.frame() %>%
rownames_to_column("year") %>%
pivot_longer(!year, values_to = "obs", names_to = "pixel") %>%
filter(pixel == px) %>%
mutate(year = as.numeric(year)) %>%
select(!pixel)
# combine predictions and observations into one dataframe
plot.dat <- left_join(Ndat, lat.med) %>%
left_join(.,lat.low) %>% left_join(.,lat.up) %>%
left_join(.,med.pred) %>% left_join(.,low.pred) %>%
left_join(.,up.pred) %>% mutate(year = year+1985)
# plot
(test <- plot.dat %>%
ggplot(aes(x = year, y = obs)) +
geom_point(aes(x = year, y = obs)) +
geom_line(aes(x = year, y = obs), lty = 2) +
geom_ribbon(aes(ymin = lat.low, ymax = lat.up),
alpha=0.5, fill = "darkgrey") +
geom_line(aes(x = year, y = lat.med), col = "darkgrey") +
geom_ribbon(aes(ymin = low.pred, ymax = up.pred), alpha=0.3, fill = "#00BFC4") +
geom_line(aes(x = year, y = med.pred), col = "#00BFC4") +
scale_y_continuous(limits = c(-2, 20)) +
labs(x = "YEAR", y = "TREE COVER (%)") +
theme(legend.position="none", text = element_text(size=5)) +
theme_classic())
}
plot_lat_gg(774)
